<!-- Loading -->
<ng-container *ngIf="bidIsLoading$ | async">
  <div class="row">
    <div class="col-12">
      <div class="d-flex justify-content-center pt-5">
        <div class="spinner-border text-primary">
          <span class="visually-hidden">Loading...</span>
        </div>
      </div>
    </div>
  </div>
</ng-container>

<!-- Bid page -->
<ng-container *ngIf="(bidIsLoading$ | async) === false && (bid$ | async) !== null">
  <ng-container *ngIf="bid$ | async as bid">
    <!-- Header -->
    <app-use-cases-header [header]="(successfulHeader$ | async)!"></app-use-cases-header>
    <!-- Body -->
    <div class="container">
      <!-- Description -->
      <div class="row">
        <div class="col-12">
          <div class="accordion mb-3">
            <div class="accordion-item">
              <h2 class="accordion-header">
                <button
                  class="accordion-button collapsed"
                  type="button"
                  data-bs-toggle="collapse"
                  data-bs-target="#collapseThree"
                  aria-expanded="false"
                  aria-controls="collapseThree"
                >
                  Description
                </button>
              </h2>
              <div id="collapseThree" class="accordion-collapse collapse" data-bs-parent="#accordionExample">
                <div class="accordion-body">
                 {{bid.description}}
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <!-- Carousel -->
      <div class="card border-0 shadow mb-4">
        <div class="card-body p-0">
          <div id="carouselExampleIndicators" class="carousel slide" data-bs-ride="carousel">
            <div class="carousel-indicators">
              <button
                *ngFor="let item of bid.imgLists; let i = index"
                type="button"
                data-bs-target="#carouselExampleIndicators"
                [attr.data-bs-target]="'#carouselExampleIndicators'"
                [attr.data-bs-slide-to]="i"
                [class.active]="i === 0"
                [attr.aria-current]="i === 0 ? 'true' : null"
                [attr.aria-label]="'Slide ' + (i + 1)"
              ></button>
            </div>
            <div class="carousel-inner">
              <div
                class="carousel-item"
                *ngFor="let item of bid.imgLists; let i = index"
                [ngClass]="{ active: i === 0 }"
              >
                <img [src]="item" class="d-block w-100" />
              </div>
            </div>
            <button
              class="carousel-control-prev"
              type="button"
              data-bs-target="#carouselExampleIndicators"
              data-bs-slide="prev"
            >
              <span class="carousel-control-prev-icon" aria-hidden="true"></span>
              <span class="visually-hidden">Previous</span>
            </button>
            <button
              class="carousel-control-next"
              type="button"
              data-bs-target="#carouselExampleIndicators"
              data-bs-slide="next"
            >
              <span class="carousel-control-next-icon" aria-hidden="true"></span>
              <span class="visually-hidden">Next</span>
            </button>
          </div>
        </div>
        <div class="card-footer pt-3">
          <div class="d-flex justify-content-between align-items-center mb-2">
            <span class="text-muted">{{bid.ownerName}}</span>
            <span>{{getCountdown(bid.auctionEndTime)|async}}</span>
          </div>
        </div>
      </div>
      <!-- Current bid -->
      <div class="row justify-content-center my-3">
        <div class="col-12">
          <mat-form-field class="example-form-field w-100" appearance="outline">
            <button matPrefix mat-icon-button>
              <i class="bi bi-dash-circle"></i>
            </button>
            <input matInput type="text" [value]="bid.highestBid" class="text-center" />
            <mat-hint>The current bid is at <strong>{{bid.highestBid}} ETH</strong></mat-hint>
            <button matSuffix mat-icon-button>
              <i class="bi bi-plus-circle"></i>
            </button>
          </mat-form-field>
        </div>
      </div>
      <!-- Action button -->
      <div class="row my-2">
        <div class="col-12">
          <app-chainbrary-button [buttonClasses]="['btn-primary-gradient', 'text-light']" buttonText="Set the bid" />
        </div>
      </div>
      <!-- History -->
      <div class="row mt-3">
        <h5>History of Bid</h5>
        <ul class="list-group list-group-flush shadow-sm">
          <li class="list-group-item" *ngFor="let bid of [1, 2, 3, 4]">
            <span>x name</span>
            <span class="float-end">{{ bid }} ETH</span>
            <br />
            <small class="text-muted">
              <!-- {{bid.date | date:'mediumTime'}} -->
              xx date
            </small>
          </li>
        </ul>
      </div>
    </div>
  </ng-container>
</ng-container>

<!-- Bid not found -->
<ng-container *ngIf="(bidError$ | async) !== null">
  <app-use-cases-header [header]="headerPayload"></app-use-cases-header>
  <div class="container">
    <div class="row">
      <div class="col-12">
        <div class="d-flex justify-content-center">
          <div class="alert alert-danger border-0" role="alert">
            <h4 class="alert-heading">Bid not found</h4>
            <p>
              The bid you are looking for does not exist. Please check the URL or go back to the
              <a routerLink="/use-cases/search">search</a> page.
            </p>
          </div>
        </div>
      </div>
    </div>
  </div>
</ng-container>
